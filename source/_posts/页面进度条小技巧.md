---
title: 页面进度条小技巧
date: 2017-04-03 18:58:15
tags:
- 前端
catalogies:
- 学习笔记
---

# 前言

今天学到一招小技巧：页面加载进度条。

<!--more-->

# 什么是页面加载进度条？

当打开一个网页地址时，浏览器发出HTTP请求，从服务器上获取网页源文件，随后浏览器进行渲染，直到网页完全加载完毕，这个过程是需要耗费时间的。。。（这个浏览器工作原理和流程有篇文章写的很详细[浏览器的工作原理：新式网络浏览器幕后揭秘](https://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/)）

不废话了，其实就是将网页加载进度直观显示的一个样式而已。比如说好多页面布局里喜欢在顶部header上放条线，然后这条线在网页加载时就变成进度条样式。

# 正题

之前没有实现过，我的思路是用js获取网页的加载状态，类似window.onload。但我没能找到能获取isLoading状态这样的api，倒是XHR里有这样的Progress Events（高程三21.3）。

今天在看别人源代码的时候突然发现如下的小技巧：

```html
<html>
<head>
    <script> 
    function progress(num){
        document.getElementById('progress-bar').style.width = num + '%';
    }
    </script>
</head>
<body>

    ...
    <script>progress(20)</progress>
    ...

    ...
    <script>progress(50)</progress>
    ...

    ...
    <script>progress(80)</progress>
    ...

    ...
    <script>progress(100)</progress>
    ...

```

原理就是：
- 将修改进度条样式的函数写进head里
- 当网页加载过程中，渲染dom的过程中触发这个函数
